<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stravibe Navbar</title>
    <link rel="stylesheet" href="/css/output.css" />
  </head>
  <body>
    <nav class="bg-gray-800 p-4" th:fragment="*">
      <div class="container mx-auto flex justify-between items-center">
        <!-- Logo -->
        <a href="#" class="text-lg font-bold">Stravibe</a>

        <!-- Navbar Menu -->
        <div class="flex space-x-8">
          <!-- Navbar Before Login -->
          <ul id="nav-before-login" class="hidden flex space-x-4">
            <li>
              <a href="/register" class="hover:text-gray-400">Register</a>
            </li>
            <li>
              <a href="/login" class="hover:text-gray-400">Login</a>
            </li>
          </ul>

          <!-- Navbar After Login -->
          <ul id="nav-after-login" class="hidden flex space-x-8 items-center">
            <!-- Member Menu -->
            <li id="member-menu" class="hidden relative">
              <button
                id="btn-aktivitas"
                class="hover:text-gray-400 focus:outline-none"
              >
                Aktivitas
              </button>
              <div
                id="dropdown-aktivitas"
                class="absolute left-0 mt-2 w-48 bg-white text-black shadow-lg hidden z-50"
              >
                <a href="/aktivitas" class="block px-4 py-2 hover:bg-gray-100"
                  >List Aktivitas</a
                >
                <a
                  href="/aktivitas/tambah"
                  class="block px-4 py-2 hover:bg-gray-100"
                  >Tambah Aktivitas</a
                >
              </div>
            </li>
            <li id="member-menu" class="hidden relative">
              <button
                id="btn-lomba"
                class="hover:text-gray-400 focus:outline-none"
              >
                Lomba
              </button>
              <div
                id="dropdown-lomba"
                class="absolute left-0 mt-2 w-48 bg-white text-black shadow-lg hidden z-50"
              >
                <a
                  href="/member/lomba/berlangsung"
                  class="block px-4 py-2 hover:bg-gray-100"
                  >Daftar Lomba</a
                >
                <a
                  href="/member/lomba/diikuti"
                  class="block px-4 py-2 hover:bg-gray-100"
                  >History Lomba</a
                >
              </div>
            </li>
            <li>
              <a href="/member/dashboard" class="hover:text-gray-400"
                >Dashboard</a
              >
            </li>

            <!-- Admin Menu -->
            <li id="admin-menu" class="hidden relative">
              <button
                id="btn-admin-lomba"
                class="hover:text-gray-400 focus:outline-none"
              >
                Lomba
              </button>
              <div
                id="dropdown-admin-lomba"
                class="absolute left-0 mt-2 w-48 bg-white text-black shadow-lg hidden z-50"
              >
                <a href="/admin/lomba" class="block px-4 py-2 hover:bg-gray-100"
                  >List Lomba</a
                >
                <a
                  href="/admin/lomba/tambah"
                  class="block px-4 py-2 hover:bg-gray-100"
                  >Tambah Lomba</a
                >
              </div>
            </li>
            <li>
              <a href="/logout" class="text-red-500 hover:text-red-300"
                >Logout</a
              >
            </li>
          </ul>
        </div>
      </div>
      <!-- Script -->
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          // Simulasi login dan role
          const isLoggedIn = true; // Ubah ke true jika user sudah login
          const userRole = "member"; // 'member' atau 'admin'

          // Ambil elemen
          const navBeforeLogin = document.getElementById("nav-before-login");
          const navAfterLogin = document.getElementById("nav-after-login");
          const memberMenu = document.getElementById("member-menu");
          const adminMenu = document.getElementById("admin-menu");

          // Set visibilitas navbar
          if (isLoggedIn) {
            navBeforeLogin.classList.add("hidden");
            navAfterLogin.classList.remove("hidden");

            if (userRole === "member") {
              memberMenu.classList.remove("hidden");
              adminMenu.classList.add("hidden");
            } else if (userRole === "admin") {
              adminMenu.classList.remove("hidden");
              memberMenu.classList.add("hidden");
            }
          } else {
            navBeforeLogin.classList.remove("hidden");
            navAfterLogin.classList.add("hidden");
          }

          // Dropdown Logic
          const setupDropdown = (buttonId, dropdownId) => {
            const button = document.getElementById(buttonId);
            const dropdown = document.getElementById(dropdownId);

            // Tampilkan/Hide dropdown saat tombol diklik
            button.addEventListener("click", (e) => {
              e.stopPropagation();
              dropdown.classList.toggle("hidden");
            });

            // Sembunyikan dropdown saat klik di luar
            document.addEventListener("click", (e) => {
              if (!dropdown.contains(e.target) && !button.contains(e.target)) {
                dropdown.classList.add("hidden");
              }
            });
          };

          setupDropdown("btn-aktivitas", "dropdown-aktivitas");
          setupDropdown("btn-lomba", "dropdown-lomba");
          setupDropdown("btn-admin-lomba", "dropdown-admin-lomba");
        });
      </script>
    </nav>
  </body>
</html>
